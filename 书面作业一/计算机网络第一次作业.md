# 计算机网络第一次作业

> 朱浩泽 1911530 计算机科学与技术 

## 题目一

##### 通过使用Windows命令行模式提供的nslookup命令查询www.baidu.com的IP地址，给出结果截图，并对返回的结果进行解释。同时，利用Wireshark捕获查询的交互过程，给出结果截图，并进行简要说明。

1. 查询IP地址截图

   ![屏幕快照 2021-11-01 20.42.15](\屏幕快照 2021-11-01 20.42.15.png)

   - 服务器代表的是DNS服务器名称（由于是macOS环境下运行的VMware虚拟机，nslookup未能解析此项）
   - address表示的是DNS服务器地址
   - 名称代表显示的是百度原来的网址
   - 剩下的Addresses是百度的IP地址。可以看出，这是一个IPV4协议的地址；39说明网络类型为A类。
   - Aliaes代表目标域名

2. 利用Wireshark捕获交互过程

   ![屏幕快照 2021-11-01 21.39.53](\屏幕快照 2021-11-01 21.39.53.png)

   ![屏幕快照 2021-11-01 21.39.51](\屏幕快照 2021-11-01 21.39.51.png)

   可以看出，首先nslookup本机的IP地址是192.168.34.129，服务器地址是192.168.34.2，使用的是DNS协议。本机首先向服务器发出查询请求，然后服务器解析IP找到主机，做出响应。接着，主机向服务器发送查询www.baidu.com.localdomian的IPV4信息的对应请求，服务器接受到请求后作出响应。之后，服务器做出应答，为A类域名，网址为www.baidu.com.localdomain，CNAME为其别名www.a.shhifen.com，IP地址为39.156.66.188。同时还可以看出，DNS为应用层协议，下层传输层采用UDP，再下层网络层是IPV4协议。响应时间为0.045960000 seconds。

## 题目二

##### 以反复解析为例，说明域名解析的基本工作过程（可以结合图例）。给出内容分发网络（CDN）中DNS重定向的基本方法，说明原始资源记录应该如何修改，并描述重定向过程。

![屏幕快照 2021-11-02 14.26.04](/Users/zhuhaoze/Desktop/南开大学/计算机网络/书面作业一/屏幕快照 2021-11-02 14.26.04.png)

1. 主机想知道某个域名的IP地址，先查缓存是否存在。若存在直接返回，若不存在向DNS服务器发送一个DNS查询报文，该报文包含被查询的域名。
2. 若本地DNS缓存中存在该IP地址的映射，则直接跳到第8步，否则本地DNS服务器将该报文转发到根DNS服务器，执行第三步。
3. 根DNS服务器观察其所属的TLD服务器，并向本地DNS服务器返回负责该域名的TLD的IP地址列表。
4. 本地DNS服务器向这些TLP服务器之一发送查询报文。
5. 该TLD服务器观察其所属的权威DNS服务器，并用该权威DNS服务器的地址作出响应，发回本地DNS服务器。
6. 本地DNS再向该权威DNS服务发送查询报文。
7. 权威DNS服务器根据该域名进行查询，用该域名的IP地址进行响应，发回本地DNS服务器。本地DNS服务器缓存中存入该域名到IP地址的映射。
8. 本地DNS服务器将该IP地址返回请求主机，请求主机缓存该域名到IP地址的映射。至此，查询结束，一共发送了8分报文（4份查询报文和4份回答报文）。

## 题目三

##### 在DNS域名系统中，域名解析时使用UDP协议提供的传输层服务（DNS服务器使用UDP的53端口），而UDP提供的是不可靠的传输层服务，请你解释DNS协议应如何保证可靠机制。

因为UDP提供的是不可靠的传输服务，所以域名解析时的可靠性则要由应用层保障。而在DNS应用层，其报文格式中包括了问题的数量、回答的数量，可以用来进行一定的校验。返回的报文中，也包含着发送过去的问题，可以对匹配程度进行一定的比较。报文中还包含了DNS响应的数目、权威名称服务器数目以及权威名称服务器对应IP地址的数目，这些条目，也可以进行一定的校验。

同时，DNS报文还有以秒为单位的生存周期，表示资源记录的生命周期,一般用于当地址解析程序取出资源记录后決定保存及使用缓存数据的时间。当生存周期过期后，会重新请求更新，以保证数据的正确性。

DNS协议还会通过冗余设置，避免单点失效。具体来说，多个为保证高可用性，会有多台权威服务器冗余支持每个区域。某个区域的资源记录通过手动或自动方式更新到单个主权威服务器上，其它冗余名称服务器用作同一区域中主服务器的备份服务器，以防主服务器无法访问或宕机。辅 DNS服务器定期与主 DNS 服务器通讯，确保它的区域信息保持最新。

综上来看，若本机请求的IP发生错误，则会链接不上网址，发出再次请求，进行正确更新。而高层的DNS服务器则是通过冗余性和定期更新来保证可靠机制。基本上来说，只要高层DNS服务器保证了正确性，就不会发生较大的错误。